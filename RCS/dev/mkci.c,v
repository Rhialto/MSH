head	1.56;
access;
symbols
	SHAREWARE2:1.56
	MAXON5:1.55
	MAXON4:1.53
	MAXON3:1.51
	MAXON2:1.46;
locks;
comment	@ * @;


1.56
date	96.12.21.23.34.35;	author Rhialto;	state Rel;
branches;
next	1.55;

1.55
date	93.12.30.22.45.10;	author Rhialto;	state Rel;
branches;
next	1.54;

1.54
date	93.06.24.04.56.00;	author Rhialto;	state Exp;
branches;
next	1.53;

1.53
date	92.10.25.02.19.07;	author Rhialto;	state Rel;
branches;
next	1.51;

1.51
date	92.04.17.16.13.00;	author Rhialto;	state Rel;
branches;
next	1.46;

1.46
date	91.10.06.18.24.25;	author Rhialto;	state Rel;
branches;
next	1.43;

1.43
date	91.09.28.01.53.37;	author Rhialto;	state Exp;
branches;
next	;


desc
@Create c.i file (for assembly) from .h files
@


1.56
log
@No changes.
@
text
@/*
 * $Id: mkci.c,v 1.55 1993/12/30 22:45:10 Rhialto Rel $
 * $Log: mkci.c,v $
 * Revision 1.55  1993/12/30  22:45:10  Rhialto
 * Add hardware constants.
 * Freeze for MAXON5.
 *
 * Revision 1.54  1993/06/24  04:56:00	Rhialto
 * DICE 2.07.54R.
 *
 * Revision 1.53  92/10/25  02:19:07  Rhialto
 * Add some symbols.
 *
 * Revision 1.51  92/04/17  16:13:00  Rhialto
 * Freeze for MAXON3.
 *
 * Revision 1.46  91/10/06  18:24:25  Rhialto
 *
 * Freeze for MAXON
 *
 * Revision 1.43  91/09/28  01:53:37  Rhialto
 * *** empty log message ***
 *
 * MKCI.C
 *
 * Generate c.i file for assembly parts to export stuff from C to ASM level.
 */

#include "device.h"
#include "layout.h"
#include <exec/resident.h>
#include <stdio.h>

#define OFFSETOF(tag, member)   ((long)(&((struct tag *)0)->member))
#define OFFSET(label, structure, member) \
	printf("%s\tEQU %d\n", label, OFFSETOF(structure, member))
#define VALUE(label, value) \
	printf("%s\tEQU %d\n", label, value)

/* Grr.. Dice does't ge t the following right... */
#define DEFINE(label)   \
	printf(#label "\tEQU %d\n", label)


long
log2(unsigned long x)
{
    long log;

    if (x) {
	for (log = -1; x; log++)
	    x >>= 1;

	return log;
    } else {
	return -1;
    }
}

main(argc, argv)
int argc;
char **argv;
{
    if (argc > 1)
	freopen(argv[1], "w", stdout);

    printf("; Generated by $Id: mkci.c,v 1.55 1993/12/30 22:45:10 Rhialto Rel $\n; Don't edit by hand!\n");

    OFFSET("md_Rawbuffer", MessyDevice, md_Rawbuffer);
    OFFSET("md_MfmDecode", MessyDevice, md_MfmDecode[0]);
    VALUE("md_SIZEOF", sizeof(struct MessyDevice));

    OFFSET("mu_TrackBuffer", MessyUnit, mu_TrackBuffer);
    OFFSET("mu_CrcBuffer", MessyUnit, mu_CrcBuffer[0]);
    OFFSET("mu_SectorStatus", MessyUnit, mu_SectorStatus[0]);
    OFFSET("mu_InitSectorStatus", MessyUnit, mu_InitSectorStatus);
    OFFSET("mu_CurrentTrack", MessyUnit, mu_CurrentTrack);
    VALUE("MS_NSIDES", MS_NSIDES);
    VALUE("LOG2_MS_NSIDES", log2(MS_NSIDES));
    OFFSET("mu_CurrentSectors", MessyUnit, mu_CurrentSectors);
    OFFSET("mu_ReadLen", MessyUnit, mu_ReadLen);
    OFFSET("mu_WriteLen", MessyUnit, mu_WriteLen);

#ifdef READONLY
    VALUE("READONLY", 1);
#else
    VALUE("READONLY", 0);
#endif
#ifdef HANDLE_IO_QUICK
    VALUE("HANDLE_IO_QUICK", 1);
#else
    VALUE("HANDLE_IO_QUICK", 0);
#endif
    VALUE("UNITB_ACTIVE", UNITB_ACTIVE);
    VALUE("MS_BPS", MS_BPS);
    VALUE("MS_BPScode", log2(MS_BPS / 128));
    VALUE("LOG2_MS_BPS", log2(MS_BPS));
    VALUE("MS_SPT", MS_SPT);
    VALUE("MS_SPT_MAX", MS_SPT_MAX);
    VALUE("VERSION", VERSION);
    VALUE("REVISION", REVISION);

    /* Some system include values: */
    VALUE("RTC_MATCHWORD", RTC_MATCHWORD);
    VALUE("RTF_AUTOINIT", RTF_AUTOINIT);
    VALUE("NT_DEVICE", NT_DEVICE);
    VALUE("LIBF_CHANGED", LIBF_CHANGED);
    VALUE("LIBF_SUMUSED", LIBF_SUMUSED);

    OFFSET("ln_Type", Node, ln_Type);
    OFFSET("ln_Name", Node, ln_Name);
    OFFSET("dev_Flags", MessyDevice, dev_Flags);
    OFFSET("dev_Version", MessyDevice, dev_Version);
    OFFSET("dev_Revision", MessyDevice, dev_Revision);
    OFFSET("dev_IdString", MessyDevice, dev_IdString);
/*
:.+1,$s/DEFINE(\(.*\));/VALUE("\1", \1);/
*/
    VALUE("INDEXSYNC", INDEXSYNC);
    VALUE("SYNC", SYNC);
    VALUE("TLEN", TLEN);

    VALUE("INDEXGAP", INDEXGAP);
    VALUE("INDXGAP", INDXGAP);
    VALUE("INDXSYNC", INDXSYNC);
    VALUE("INDXMARK", INDXMARK);
    VALUE("INDEXGAP2", INDEXGAP2);

    VALUE("IDGAP2", IDGAP2);
    VALUE("IDSYNC", IDSYNC);
    VALUE("IDMARK", IDMARK);
    VALUE("IDDATA", IDDATA);
    VALUE("IDCRC", IDCRC);

    VALUE("DATAGAP1", DATAGAP1);
    VALUE("DATAGAP2", DATAGAP2);
    VALUE("DATASYNC", DATASYNC);
    VALUE("DATAMARK", DATAMARK);
    VALUE("DATACRC", DATACRC);

    return 0;
}

@


1.55
log
@Add hardware constants.
Freeze for MAXON5.
@
text
@d2 1
a2 1
 * $Id: mkci.c,v 1.54 1993/06/24 04:56:00 Rhialto Exp $
d4 4
d67 1
a67 1
    printf("; Generated by $Id: mkci.c,v 1.54 1993/06/24 04:56:00 Rhialto Exp $\n; Don't edit by hand!\n");
@


1.54
log
@DICE 2.07.54R.
@
text
@d2 5
a6 2
 * $Id: mkci.c,v 1.53 92/10/25 02:19:07 Rhialto Rel $
 * $Log:	mkci.c,v $
d26 1
d34 6
a39 1
	printf("%s\tEQU %d\n", label, value);
d63 1
a63 1
    printf("; Generated by $Id: mkci.c,v 1.53 92/10/25 02:19:07 Rhialto Rel $\n; Don't edit by hand!\n");
d69 1
a69 1
    OFFSET("mu_TrackBuffer", MessyUnit, mu_TrackBuffer[0]);
d112 24
@


1.53
log
@Add some symbols.
@
text
@d2 1
a2 1
 * $Id: mkci.c,v 1.51 92/04/17 16:13:00 Rhialto Rel $
d4 3
d23 1
d54 1
a54 1
    printf("; Generated by $Id: mkci.c,v 1.51 92/04/17 16:13:00 Rhialto Rel $\n; Don't edit by hand!\n");
d58 1
d68 2
d88 15
@


1.51
log
@Freeze for MAXON3.
@
text
@d2 1
a2 1
 * $Id: mkci.c,v 1.46 91/10/06 18:24:25 Rhialto Rel $
d4 3
a18 2
#include <amiga.h>
#include "dev.h"
d50 1
a50 1
    printf("; Generated by $Id: mkci.c,v 1.46 91/10/06 18:24:25 Rhialto Rel $\n; Don't edit by hand!\n");
d69 6
@


1.46
log
@
Freeze for MAXON
@
text
@d2 1
a2 1
 * $Id: mkci.c,v 1.43 91/09/28 01:53:37 Rhialto Exp $
d4 4
d49 1
a49 1
    printf("; Generated by $Id$\n; Don't edit by hand!\n");
d58 3
a60 2
    OFFSET("mu_CurrentCylinder", MessyUnit, mu_CurrentCylinder);
    OFFSET("mu_CurrentSide", MessyUnit, mu_CurrentSide);
d73 1
@


1.43
log
@*** empty log message ***
@
text
@d2 5
a6 2
 * $Id$
 * $Log$
d44 2
@
